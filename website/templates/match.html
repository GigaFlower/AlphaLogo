{% extends "layout.html" %}

{% block title %}
    <title>LOGO相似匹配 - AlphaLogo</title>
{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="static/search_match.css">
{% endblock %}

{% block scripts %}
    <script src="static/search_match.js"></script>
    <script src="static/match.js"></script>
    <script src="static/jquery.js"></script>
	<script src="static/jquery.peity.js"></script>
{% endblock %}

{% block body %}
    <div class="container" id="totalContainer">
        <div class="titleContainerDefault" id="titleContainer">
            <div class="title" id="title">
                AlphaLogo
            </div>
            <div class="linkBar">
                <div class="currentLinkTitle" id="search">
                    <span class="textDefaultStyle">搜索</span>
                </div>
                <div class="linkTitle" id="match">
                    <span class="textDefaultStyle">匹配</span>
                </div>
            </div>
            <div class="input" id="inputSearch" hidden>
                <form id="textForm" action="/search" method="GET">
                    <input type="text" class="keyword" name="kw" placeholder="请输入要搜索的logo特征">
                    <input name="type" id="typeSearch" value="search" hidden>
                    <input type="text" id="enterpriseName" name="enterpriseName" value="" hidden>
                    <input type="text" id="nColors" name="nColors" value="0,0,0,0,0" hidden>
                    <input type="text" id="saturation" name="saturation" value="0,0,0" hidden>
                    <input type="text" id="brightness" name="brightness" value="0,0,0" hidden>
                    <div class="passiveAdvancedTitle" id="advanced">
                        <span class="textDefaultStyle">高级搜索</span>
                    </div>
                    <button type="submit" class="submit">Go</button>
                </form>
            </div>
            <div class="input" id="inputMatch">
                <form id="imageForm" action="/match" enctype="multipart/form-data" method="POST">
                    <input type="text" name="textfield" id="textfield" class="textfield" value="{{ kw }}" disabled="disable"> 
                    <input type="file" class="logo" id="logo" name="logo" onchange="showTextField()">
                    <input type="button" class="browse" id="browse" value="浏览">
                    <input name="type" id="typeMatch" value="match" hidden>
                    <button type="submit" class="submit" id="imgSubmit">Go</button> 
                </form>
            </div>

            {% include "advanced_search_panel.html" %}
        </div>

        <div class="container" id="rightSideContainer">

            <div class="moreInfoTargetImgDiv" id="previewDiv">
                <div class="previewImgDiv" id="previewImgDiv">
                    <img src="/static/uploads/{{ upload.filename }}" class="previewImg" id="previewImg">
                </div>

                <div class="moreInfoContainer" id="moreInfoContainerForPreview" >
                    <!-- Write the codes of moreInfoContainer here, including various infos of the certain picture(preview image here), the color graph and the style. The border is shown only for the location, which needn't be used in the future. 
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
                    <div class="moreInfoTitle" style="line-height: 125%; text-align: left; " style="text-">
                        <h1 style="font-size: 15px"> 产品或组织名称： </h1>
                        {{ upload.ent_name }}
                    </div>

                    </br>

                    

					<div class="moreInfoPie" style="line-height: 125%; text-align: left;" s>
                        <h1 style="font-size: 15px"> 图像sv数据：</h1>
                        <h6 style="font-size: 11px;">灰度:{{upload.s}}</h6>
                        <div class="rectangle">
                            <div class="rectanglePart" id="rect1">灰度:{{upload.s}}</div>
                        </div>
                        <h6 style="font-size: 11px;">鲜艳度:{{upload.v}}</h6>
                        <div class="rectangle2">
                            <div class="rectanglePart2" id="rect2">鲜艳度:{{upload.v}}</div>
                        </div>
                        </br>
                        <h1 style="font-size: 15px"> 图像主要颜色占比图：</h1>
                        <div class="pieAnimationDiv" style="font-size: 0px; display:block;float: left; min-width: 81px;min-height: 91px;">
                            <span id="pie1" class="pie">{{upload.theme_weights | join(",")}},800
                            </span>
                        </div>
                        <div style="width:12px;height:50px;float: left;display: block;"></div>
                        <div style="display: block;float: left">
                        <div style="height:19px;width:110px;border-width:0px; border-style: solid; display: block;background-color: transparent;"></div>
                            <div style="height:8px;width:8px;padding: 0;border-width:1px; border-style: solid; display: block;background-color: {{upload.theme_colors[0]}}">
                                <a onlick="return false;" title={{upload.theme_colors[0]}}s style="float:left; width:9px;height:9px;text-decoration: none;"></a>
                            </div>
                            <div style="font-size: 10px;display: block; margin:auto"> {{upload.theme_weights[0]}} </div>
                            <div style="height:8px;width:8px; border-width: 1px;border-style: solid;display: block;background-color: {{upload.theme_colors[1]}}">
                                <a onlick="return false;" title={{upload.theme_colors[1]}} style="float:left; width:9px;height:9px;text-decoration: none;"></a>
                            </div>
                            <div style="font-size: 10px;display: block; margin:auto"> {{upload.theme_weights[1]}} </div>
                        </div>
                    </div>
                    </br>
                    <div  style="height: 150px; overflow-x: hidden; min-width: 150px;";>
                    <p style="text-indent: 2em;font-size: 15px; text-align:justify; line-height: 120%">
                    饼图的颜色还不是实际的分布颜色，需要更改。未来需要把style等属性移到css！！！
                    <a onclick="return false;" title="饼图的颜色还不是实际的分布颜色，需要更改。&#13;未来需要把style等属性移到css！！！" 
                    style="float:left;width: auto;text-indent: 0;background-color:#33CC70 ;text-decoration: none;cursor:default;color: #FFFFFF">MORE</a>
                    {{ upload.info }}
                    </p>
                    </div>
<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

                </div>
            </div>

            <div class="moreInfoChosenImgDivLeft" id="chosenImgDiv">
                {% include "moreinfo_side_container.html" %}
            </div>
        </div>


        <div class="leftPositionedResultContainer" id="resultContainer">
            <div class="container" id="matchedResultContainer">

                {% if (logo_matched|length > 0) %}
                    <div class="resultTitle" id="matchedResultTitle">
                        您要找的是不是：
                    </div>
                    {%- for row in logo_matched|batch(2) %}
                        <div class="imgMatchedResultRow">
                            {%- for logo in row %}
                                <div class="matchedResult" onclick="showChosenImgMoreInfo(this, 0)" dataFilename={{logo.filename}} dataEntName={{logo.ent_name}} 
                                dataInfo={{logo.info}} dataThemeColors="{{ logo.theme_colors|string }}" dataThemeWeights={{logo.theme_weights}} dataS={{logo.s}} 
                                dataV={{logo.v}} >
                                    <div>{{ logo.ent_name }}</div>
                                    <img src="{{ url_for('static',filename=logo.filename) }}" class="matchedImg" >
                                    <div>
                                    {% for color in logo.theme_colors %}
                                        <div style="width: 20px;height: 20px;float:left;background-color: {{color}}"></div>
                                    {% endfor %}
                                    </div>
                                    {{ logo.s }}
                                    {{ logo.v }}
                                </div>
                            {%- endfor %}
                        </div>
                    {%- endfor %}
                {% endif %}
            </div>

            <div class="matchResultContainer" id="similarResultContainer">
                <div class="resultTitle" id="similarResultTitle">
                    共搜索到{{ logo_similar|length }}个相似结果
                </div>

                {%- for row in logo_similar|batch(3) %}
                    <div class="imgSimilarResultRow">
                        {%- for logo in row %}
                            <div class="similarResult" onclick="showChosenImgMoreInfo(this, 1)" dataFilename={{logo.filename}} dataEntName={{logo.ent_name}} 
                            dataInfo={{logo.info}} dataThemeColors="{{ logo.theme_colors|string }}" dataThemeWeights={{logo.theme_weights}} dataS={{logo.s}} 
                            dataV={{logo.v}} >
                                <div>{{ logo.ent_name }}</div>
                                <img src="{{ url_for('static',filename=logo.filename) }}" class="similarImg" >
                                <div>
                                {% for color in logo.theme_colors %}
                                    <div style="width: 20px;height: 20px;float:left;background-color: {{color}}"></div>
                                {% endfor %}
                                </div>
                                {{ logo.s }}
                                {{ logo.v }}
                            </div>
                        {%- endfor %}
                    </div>
                {%- endfor %}
            </div>
        </div>
    </div>
    
{% endblock %}
